(this.webpackJsonpchatchan=this.webpackJsonpchatchan||[]).push([[0],{1051:function(e,t){},1053:function(e,t){},1063:function(e,t){},1065:function(e,t){},1092:function(e,t){},1093:function(e,t){},1098:function(e,t){},1100:function(e,t){},1107:function(e,t){},1126:function(e,t){},124:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var r,n,s=a(11),o=a(12),i=a(15),c=a(16),_=a(0),p=a.n(_),l=a(8),u=a(41),A=a(17),T=(r=Object(l.b)("store"),Object(u.f)(n=r(n=Object(l.c)(n=function(e){Object(i.a)(a,e);var t=Object(c.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"change",value:function(e){this.props.store[this.props.field]=e.target.checked?"yes":"no",this.props.onUpdate&&this.props.onUpdate(this.props.store[this.props.field])}},{key:"render",value:function(){var e=this,t=1,a=Date.now(),r=this.props.field;return p.a.createElement("div",{className:"my-2 "+this.props.className||!1},p.a.createElement(A.d,{key:a+t++,checked:"yes"==this.props.store[r],label:this.props.label,onChange:function(t){return e.change(t)},inline:!0}))}}]),a}(_.Component))||n)||n)||n)},145:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var r,n,s=a(11),o=a(12),i=a(15),c=a(16),_=a(0),p=a.n(_),l=a(8),u=a(41),A=a(17),T=a(100),h=(r=Object(l.b)("store"),Object(u.f)(n=r(n=Object(l.c)(n=function(e){Object(i.a)(a,e);var t=Object(c.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return p.a.createElement(p.a.Fragment,null,p.a.createElement("div",{className:"std-hr form-div"}),p.a.createElement(A.g,null,p.a.createElement("div",{className:"flex flex-row justify-between"},p.a.createElement("div",{className:"left"},p.a.createElement(A.b,{large:"true",intent:T.a.PRIMARY,onClick:function(){return e.props.onSubmit()}},"\u63d0\u4ea4")),p.a.createElement("div",{className:"right"},this.props.cancel||p.a.createElement(A.b,{large:"true",onClick:function(){return e.props.history.goBack()},className:"right-20"},"\u53d6\u6d88")))))}}]),a}(_.Component))||n)||n)||n)},1462:function(e,t,a){"use strict";a.r(t);var r,n,s,o,i,c,_,p,l,u,A,T,h,E,P,m,O,d,b,f,C,y,N,v=a(0),I=a.n(v),S=a(38),R=a.n(S),k=(a(605),a(11)),g=a(12),j=a(15),B=a(16),x=a(29),w=a(41),U=a(8),L=Object(U.b)("store")(r=Object(U.c)(r=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){return I.a.createElement("div",{className:"title"},I.a.createElement("h1",null,"Hello\uff0c",this.props.store.appname))}}]),a}(v.Component))||r)||r,D=a(17),G=(n=Object(U.b)("store"),Object(w.f)(s=n(s=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){var e=this;return I.a.createElement("div",null,I.a.createElement("h1",null,I.a.createElement(L,null)),I.a.createElement("div",null,I.a.createElement(D.b,{onClick:function(){return e.props.store.appname+="\ud83c\udf88"}},"change")),I.a.createElement("div",null,I.a.createElement("span",{onClick:function(){return e.props.history.push("/login")}},"Login")))}}]),a}(v.Component))||s)||s),q=a(52),K=a(170),W=(o=Object(U.b)("store"),Object(w.f)(i=o(i=Object(U.c)(i=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){var e=I.a.createElement("div",{className:"p-32 "},"FrontPage");return I.a.createElement(q.a,{title:this.props.store.appname,main:e})}}]),a}(v.Component))||i)||i),a(3)),H=a.n(W),F=a(6),V=a(23),X=(c=Object(U.b)("store"),Object(w.f)(_=c(_=Object(U.c)(_=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=Object(F.a)(H.a.mark((function e(){var t,a,r,n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new URLSearchParams(this.props.location.search),a=t.get("code"),r=t.get("session"),e.next=5,this.props.store.get_token_by_code(a,r);case 5:(null===(n=e.sent)||void 0===n?void 0:n.token)&&this.props.store.set_user(n.user),Object(V.a)()?this.props.history.push("/after/login"):this.props.history.push("/home");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return I.a.createElement("div",{className:"flex flex-row pt-20 items-center justify-center"},I.a.createElement(D.n,null))}}]),a}(v.Component))||_)||_)||_),z=a(60),M=a(53),Y=a(220),J=(p=Object(U.b)("store"),Object(w.f)(l=p(l=Object(U.c)(l=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){var e;Object(k.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={qrcode_url:!1},e}return Object(g.a)(a,[{key:"go",value:function(){if(Object(V.a)())this.props.onClick&&this.props.onClick();else{var e=window.location.origin+"/login/auto/"+this.props.store.token+"?redirect="+encodeURIComponent(window.location.pathname+"?amount="+this.props.amount||100);this.setState({qrcode_url:e})}}},{key:"render",value:function(){var e=this,t=this.props,a=(t.staticContext,t.onClick,Object(M.a)(t,["staticContext","onClick"]));return I.a.createElement(I.a.Fragment,null,I.a.createElement(D.b,Object.assign({onClick:function(){return e.go()}},a)),this.state.qrcode_url&&I.a.createElement(D.l,{isOpen:this.state.qrcode_url,onClose:function(){return e.setState({qrcode_url:!1})}},I.a.createElement("div",{className:"center-box bg-white p-10 rounded"},I.a.createElement(Y.a,{value:this.state.qrcode_url}),I.a.createElement("div",{className:"mt-2"},"\u8bf7\u7528\u5fae\u4fe1\u626b\u7801\u652f\u4ed8"))))}}]),a}(v.Component))||l)||l)||l),$=(u=Object(U.b)("store"),Object(w.f)(A=u(A=Object(U.c)(A=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){var e;Object(k.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={jsinfo:!1},e}return Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=parseInt(new URLSearchParams(this.props.location.search).get("amount"));function t(){}this.props.store.recharge_input_coin||(this.props.store.recharge_input_coin=e),"undefined"==typeof WeixinJSBridge&&(document.addEventListener?document.addEventListener("WeixinJSBridgeReady",t,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",t),document.attachEvent("onWeixinJSBridgeReady",t)))}},{key:"launch",value:function(){var e=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:this.state.jsinfo.appId,timeStamp:this.state.jsinfo.timestamp,nonceStr:this.state.jsinfo.nonceStr,package:this.state.jsinfo.package,signType:this.state.jsinfo.signType,paySign:this.state.jsinfo.paySign},(function(t){"get_brand_wcpay_request:ok"==t.err_msg&&(Object(V.b)("\u652f\u4ed8\u6570\u636e\u5904\u7406\u4e2d..."),e.props.history.push("/profile"))})),console.log("launch")}},{key:"recharge",value:function(){var e=Object(F.a)(H.a.mark((function e(){var t,a=this;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.store.preorder(this.props.store.recharge_input_coin);case 2:(t=e.sent)&&(t.result&&(this.setState({jsinfo:t.result}),window.setTimeout((function(){return a.launch()}),600)),t.error&&Object(V.b)(t.error.err_code_des));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=I.a.createElement("div",{className:"p-2 recharge-page"},I.a.createElement("div",{className:"price"},(this.props.store.recharge_input_coin/100).toFixed(2)),I.a.createElement(z.a,{field:"recharge_input_coin",type:"number",placeholder:"\u8bf7\u8f93\u5165\u8981\u8d2d\u4e70\u7684"+this.props.store.coin_name+"\u6570\u91cf"}),I.a.createElement(J,{amount:this.props.store.recharge_input_coin,large:!0,onClick:function(){return e.recharge()}},"\u5145\u503c"));return I.a.createElement(q.a,{title:this.props.store.appname,main:t})}}]),a}(v.Component))||A)||A)||A),Z=(T=Object(U.b)("store"),Object(w.f)(h=T(h=Object(U.c)(h=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=Object(F.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.store.logout();case 2:this.props.history.replace("/");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=I.a.createElement("div",{className:"flex flex-row pt-20 items-center justify-center"},I.a.createElement(D.n,null));return I.a.createElement(q.a,{title:this.props.store.appname,main:e})}}]),a}(v.Component))||h)||h)||h),Q=(E=Object(U.b)("store"),Object(w.f)(P=E(P=Object(U.c)(P=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){var e;Object(k.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={user:!1},e}return Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=Object(F.a)(H.a.mark((function e(){var t;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.store.get_user_profile();case 2:(t=e.sent)&&t.user&&(this.setState({user:t.user}),this.props.store.set_user(t.user));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.user;if(!e)return null;var t=I.a.createElement("div",{className:"p-2 flex flex-col profile-page"},I.a.createElement("div",{className:"profile"},I.a.createElement("div",{className:"avatar"},I.a.createElement("img",{src:e.avatar_url,alt:""}),I.a.createElement("div",{className:"explain"},e.name))),I.a.createElement("div",{className:"detail"},I.a.createElement("div",{className:"row"},I.a.createElement("div",{className:"left"},"Level"),I.a.createElement("div",{className:"right"},e.level)),I.a.createElement("div",{className:"row"},I.a.createElement("div",{className:"left"},"Coin"),I.a.createElement("div",{className:"right"},e.coin))));return I.a.createElement(q.a,{title:this.props.store.appname,main:t})}}]),a}(v.Component))||P)||P)||P),ee=(m=Object(U.b)("store"),Object(w.f)(O=m(O=Object(U.c)(O=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"componentDidMount",value:function(){document.querySelector("#wechat-login-btn").click()}},{key:"render",value:function(){var e=I.a.createElement("div",{className:"flex flex-row pt-12 items-center justify-center"},I.a.createElement(K.a,{large:!0}));return I.a.createElement(q.a,{title:this.props.store.appname,main:e})}}]),a}(v.Component))||O)||O)||O),te=(d=Object(U.b)("store"),Object(w.f)(b=d(b=Object(U.c)(b=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){var e=I.a.createElement("div",{className:"py-5 px-5 md:px-0 text-xl"},"\u767b\u5165\u6210\u529f\uff0c\u8bf7\u56de\u5230\u7535\u8111\u70b9\u51fb\u6309\u94ae\u7ee7\u7eed\u3002\u6216\u8005\u70b9\u51fb\u53f3\u4e0a\u89d2\u83dc\u5355\u8fdb\u884c\u64cd\u4f5c\u3002");return I.a.createElement(q.a,{title:this.props.store.appname,main:e})}}]),a}(v.Component))||b)||b)||b),ae=(f=Object(U.b)("store"),Object(w.f)(C=f(C=Object(U.c)(C=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=Object(F.a)(H.a.mark((function e(){var t,a,r,n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.token,e.next=3,this.props.store.check_user_info(t);case 3:a=e.sent,console.log(a),a&&a.user&&(this.props.store.set_user(a.user),r=new URLSearchParams(this.props.location.search),(n=r.get("redirect"))||(n="/recharge"),this.props.history.push(n));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=I.a.createElement("div",{className:"py-5 px-5 md:px-0"},I.a.createElement("div",{className:"p-5 flex justify-center"},I.a.createElement(D.n,null)));return I.a.createElement(q.a,{title:this.props.store.appname,main:e})}}]),a}(v.Component))||C)||C)||C),re=a(304),ne=a(482),se=a(145),oe=(y=Object(U.b)("store"),Object(w.f)(N=y(N=Object(U.c)(N=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"submit",value:function(){var e=Object(F.a)(H.a.mark((function e(){var t,a,r,n,s,o;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.store._donate_keys.trim().split("\n"),a=[],Object(V.b)("\u6b63\u5728\u9a8c\u8bc1KEY\uff0c\u8bf7\u7a0d\u5019"),r=Object(ne.a)(t),e.prev=4,r.s();case 6:if((n=r.n()).done){e.next=14;break}return s=n.value,e.next=10,this.props.store.api.rawPost("".concat(this.props.store.local_apibase,"/chat/verify"),{key:s});case 10:(o=e.sent)&&"done"==o.message&&a.push(s);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:if(!(a.length<1)){e.next=27;break}return Object(V.b)("\u6ca1\u6709\u662f\u6709\u6548\u7684KEY"),e.abrupt("return");case 27:Object(V.b)("".concat(a.length,"\u4e2aKEY\u901a\u8fc7\u6821\u9a8c\uff0c\u6b63\u5728\u63d0\u4ea4\u6570\u636e"));case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=I.a.createElement("div",{className:"p-12"},I.a.createElement("div",{className:"text-center text-2xl"},"\u8d5e\u52a9OpenAI KEY"),I.a.createElement(z.a,{type:"textarea",fill:!0,label:"OpenAI KEY",field:"_donate_keys",placeholder:"\u4e00\u884c\u4e00\u4e2aKey\uff0c\u5f62\u5982 sk... "}),I.a.createElement(z.a,{label:"\u6587\u5b57\u5e7f\u544a\u6587\u6848",field:"_donate_title",placeholder:"30\u5b57\u7b26\u5185\uff0c\u4f1a\u4eba\u5de5\u5ba1\u6838\uff0c\u8fdd\u53cd\u5185\u5730\u6cd5\u5f8b\u6cd5\u89c4\u548c\u4e0d\u771f\u5b9e\u5185\u5bb9\u5c06\u4e0d\u4f1a\u901a\u8fc7"}),I.a.createElement(z.a,{label:"\u6587\u5b57\u5e7f\u544a\u94fe\u63a5",field:"_donate_link",placeholder:"https://... \u53ef\u586b\u5165\u4e2a\u4eba\u7f51\u7ad9\u3001\u7f51\u5e97\u3001\u535a\u5ba2\u4e4b\u7c7b"}),I.a.createElement(se.a,{label:"\u63d0\u4ea4",onSubmit:function(){return e.submit()}}),I.a.createElement("div",{className:"text-lg mt-8"},"\u6548\u679c\u9884\u89c8"),I.a.createElement("div",{className:"preview border rounded p-5 mt-5"},I.a.createElement("div",{className:"line-1"},"\u60a8\u4f7f\u7528\u7684 Key \u7531 ",I.a.createElement("span",{className:"text-blue-500"},this.props.store.user.name)," \u53cb\u60c5\u63d0\u4f9b"),I.a.createElement("div",{className:"line-2 mt-3 flex flex-row item-center"},I.a.createElement("span",{className:"text-white bg-gray-300 rounded px-1 mr-2"},"\u5e7f\u544a"),I.a.createElement("a",{href:this.props.store._donate_link||"https://stack.ftqq.com/subscribe",target:"_blank"},this.props.store._donate_title||"\u65b9\u7cd6\u8d85\u7ea7\u4f1a\u5458\xb7\u52a9\u529b\u4ece\u87ba\u4e1d\u9489\u5230\u4e00\u4eba\u4f01\u4e1a"))));return I.a.createElement(q.a,{title:this.props.store.appname,main:t})}}]),a}(v.Component))||N)||N)||N),ie=a(483),ce=function(e){Object(j.a)(a,e);var t=Object(B.a)(a);function a(){return Object(k.a)(this,a),t.apply(this,arguments)}return Object(g.a)(a,[{key:"render",value:function(){return I.a.createElement(x.a,null,I.a.createElement(w.c,null,I.a.createElement(w.a,{path:"/donate",component:oe}),I.a.createElement(w.a,{path:"/chat",component:re.a}),I.a.createElement(w.a,{path:"/login/auto/:token",component:ae}),I.a.createElement(w.a,{path:"/after/login",component:te}),I.a.createElement(w.a,{path:"/profile",component:Q}),I.a.createElement(w.a,{path:"/recharge",component:$}),I.a.createElement(w.a,{path:"/logout",component:Z}),I.a.createElement(w.a,{path:"/logback",component:X}),I.a.createElement(w.a,{path:"/login",component:ee}),I.a.createElement(w.a,{path:"/index",component:G}),I.a.createElement(w.a,{path:"/share/:info",component:ie.a}),I.a.createElement(w.a,{path:"/",component:re.a})))}}]),a}(v.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var _e=a(232);console.log("Welcome to ".concat(_e.a.appname)),console.log=function(){},R.a.render(I.a.createElement(U.a,{store:_e.a},I.a.createElement(ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},170:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var r,n,s=a(53),o=a(3),i=a.n(o),c=a(6),_=a(11),p=a(12),l=a(15),u=a(16),A=a(0),T=a.n(A),h=a(8),E=a(41),P=a(17),m=a(23),O=a(220),d=a(468),b=a.n(d),f=(r=Object(h.b)("store"),Object(E.f)(n=r(n=Object(h.c)(n=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(_.a)(this,a);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={qrcode_url:!1},e}return Object(p.a)(a,[{key:"go",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.store.session=b()({length:32}),e.next=3,this.props.store.get_wechat_login_url();case 3:(t=e.sent)&&t.url&&(Object(m.a)()?window.location=t.url:(this.setState({qrcode_url:t.url}),console.log(t.url)));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"check",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.store.session,e.next=3,this.props.store.check_user_info(t);case 3:(a=e.sent)&&a.code>0?Object(m.b)("\u8bf7\u626b\u7801\u540e\u518d\u70b9\u51fb\u6b64\u6309\u94ae"):a&&a.user&&(this.props.store.set_user(a.user),this.setState({qrcode_url:!1}),Object(m.a)()?this.props.history.push("/after/login"):this.props.history.push("/home"));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props,a=(t.staticContext,t.onClick,Object(s.a)(t,["staticContext","onClick"]));return T.a.createElement(T.a.Fragment,null,T.a.createElement(P.b,Object.assign({id:"wechat-login-btn",text:"\u5fae\u4fe1\u767b\u5165",onClick:function(){return e.go()}},a)),this.state.qrcode_url&&T.a.createElement(P.l,{isOpen:this.state.qrcode_url,canOutsideClickClose:!1,onClose:function(){return e.setState({qrcode_url:!1})}},T.a.createElement("div",{className:"center-box bg-white p-10 rounded"},T.a.createElement(O.a,{value:this.state.qrcode_url}),T.a.createElement("div",{className:"mt-2"},T.a.createElement(P.b,{large:!0,onClick:function(){return e.check()}},"\u5fae\u4fe1\u626b\u7801\u540e\u70b9\u6b64\u7ee7\u7eed")))))}}]),a}(A.Component))||n)||n)||n)},220:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var r,n=a(14),s=a(11),o=a(12),i=a(15),c=a(16),_=a(0),p=a.n(_),l=a(41),u=a(467),A=a.n(u),T=Object(l.f)(r=function(e){Object(i.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(s.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={value:e.props.value,img_url:""},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.ck=setInterval((function(){return e.check()}),500)}},{key:"componentWillUnmount",value:function(){this.ck&&clearInterval(this.ck)}},{key:"check",value:function(){var e=document.getElementById("theqr__inbox");e&&(this.setState({img_url:e.toDataURL("image/png")}),clearInterval(this.ck))}},{key:"render",value:function(){return p.a.createElement("div",{className:this.props.className},this.state.img_url.length>0?p.a.createElement("img",{style:{maxWidth:200},src:this.state.img_url}):p.a.createElement(A.a,Object(n.a)({size:200,value:this.state.value,includeMargin:!0,id:"theqr__inbox"},"includeMargin",!0)))}}]),a}(_.Component))||r},23:function(e,t,a){"use strict";a(232);var r=a(17),n=a(54),s=r.r.create({className:"lm-toaster",position:n.a.TOP});a(652),a(653);function o(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)}function i(e){s.show({message:e})}a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return i}))},232:function(e,t,a){"use strict";var r,n,s,o,i,c,_,p,l,u,A,T,h,E,P,m,O,d,b,f,C,y,N,v,I,S,R,k,g,j,B,x,w,U,L,D,G,q,K,W,H=a(3),F=a.n(H),V=a(6),X=a(31),z=a(11),M=a(12),Y=a(30),J=(a(634),a(10)),$=a(23),Z=a(234),Q=a.n(Z),ee=function(){function e(t){Object(z.a)(this,e),this.store=t}return Object(M.a)(e,[{key:"get",value:function(){var e=Object(V.a)(F.a.mark((function e(t){var a,r,n=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.length>1&&void 0!==n[1]?n[1]:null,r=null==a?this.store.apibase+t:this.store.apibase+t+ds+new URLSearchParams(a).toString(),e.abrupt("return",this.rawGet(r));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rawGet",value:function(){var e=Object(V.a)(F.a.mark((function e(t){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,Q.a.get(t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.return_data.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(V.a)(F.a.mark((function e(t){var a,r,n,s,o=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:null,r=!(o.length>2&&void 0!==o[2])||o[2],n=!(o.length>3&&void 0!==o[3])||o[3],s=this.store.apibase+t,e.abrupt("return",this.rawPost(s,a,r,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rawPost",value:function(){var e=Object(V.a)(F.a.mark((function e(t){var a,r,n,s,o=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:null,r=!(o.length>2&&void 0!==o[2])||o[2],n=!(o.length>3&&void 0!==o[3])||o[3],e.prev=3,s=new URLSearchParams,a&&Object.keys(a).forEach((function(e){return s.append(e,a[e])})),r&&this.store.token&&s.append("token",this.store.token),e.t0=this,e.next=10,Q.a.post(t,s);case 10:return e.t1=e.sent,e.t2=n,e.abrupt("return",e.t0.return_data.call(e.t0,e.t1,e.t2));case 15:return e.prev=15,e.t3=e.catch(3),console.log(e.t3),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,this,[[3,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=Object(V.a)(F.a.mark((function e(t){var a,r,n,s,o=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:null,r=!(o.length>2&&void 0!==o[2])||o[2],n=!(o.length>3&&void 0!==o[3])||o[3],s=new FormData,a&&Object.keys(a).forEach((function(e){return s.append(e,a[e])})),r&&this.store.token&&s.append("token",this.store.token),e.t0=this,e.next=9,Q.a.post(this.store.apibase+t,s);case 9:return e.t1=e.sent,e.t2=n,e.next=13,e.t0.return_data.call(e.t0,e.t1,e.t2);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"return_data",value:function(){var e=Object(V.a)(F.a.mark((function e(t){var a=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.length>1&&void 0!==a[1])||a[1],200!=parseInt(t.status)){e.next=8;break}if(!t.data){e.next=5;break}return 80403==t.data.code&&(Object($.b)("\u8bf7\u767b\u5165\u540e\u7ee7\u7eed"),window.location="/login"),e.abrupt("return",t.data);case 5:return e.abrupt("return",!1);case 8:console.log(t);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),te=(r=function(){function e(){Object(z.a)(this,e),Object(X.a)(this,"appname",n,this),Object(X.a)(this,"apibase",s,this),Object(X.a)(this,"local_apibase",o,this),Object(X.a)(this,"session",i,this),Object(X.a)(this,"token",c,this),Object(X.a)(this,"user",_,this),Object(X.a)(this,"api_endpoints",p,this),this.version=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_VERSION||"1.0.21",this.endpoint_count=0,this.ftopenapp_id="26",this.to_save_vars=["user","token","_chat_saved_list","_chat_model","_chat_key","_chat_api_url","_chat_avatar_url","_chat_max_tokens","_chat_temperature","_chat_timeout","_chat_char_opacity","_chat_system_prompt","_chat_user_prompt","_chat_last","_chat_history_count","_chat_auto_save","_chat_summarize_content","_chat_auto_audio","_chat_bg_url","_chat_pin_window","_preset_saved_list","_chat_stream","_chat_change_model"],Object(X.a)(this,"menu",l,this),Object(X.a)(this,"coin_name",u,this),Object(X.a)(this,"recharge_input_coin",A,this),Object(X.a)(this,"_donate_keys",T,this),Object(X.a)(this,"_donate_title",h,this),Object(X.a)(this,"_donate_link",E,this),Object(X.a)(this,"_chat_model",P,this),Object(X.a)(this,"_chat_saved_list",m,this),Object(X.a)(this,"_preset_saved_list",O,this),Object(X.a)(this,"_chat_key",d,this),Object(X.a)(this,"_chat_api_url",b,this),Object(X.a)(this,"_chat_avatar_url",f,this),Object(X.a)(this,"_chat_bg_url",C,this),Object(X.a)(this,"_chat_max_tokens",y,this),Object(X.a)(this,"_chat_temperature",N,this),Object(X.a)(this,"_chat_timeout",v,this),Object(X.a)(this,"_chat_system_prompt",I,this),Object(X.a)(this,"_chat_user_prompt",S,this),Object(X.a)(this,"_chat_char_opacity",R,this),Object(X.a)(this,"_chat_history_count",k,this),Object(X.a)(this,"_chat_last",g,this),Object(X.a)(this,"_chat_auto_save",j,this),Object(X.a)(this,"_chat_summarize_content",B,this),Object(X.a)(this,"_chat_auto_audio",x,this),Object(X.a)(this,"_chat_pin_window",w,this),Object(X.a)(this,"_preset_system_prompt",U,this),Object(X.a)(this,"_preset_user_prompt",L,this),Object(X.a)(this,"_preset_prompt_title",D,this),Object(X.a)(this,"_preset_prompt_id",G,this),Object(X.a)(this,"_chat_moderation_on",q,this),Object(X.a)(this,"_chat_stream",K,this),Object(X.a)(this,"_chat_change_model",W,this),this.api=new ee(this),this.load_vars(),this.load_api_endpoints()}return Object(M.a)(e,[{key:"load_api_endpoints",value:function(){var e=Object(V.a)(F.a.mark((function e(){var t,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://domain.api2d.org/");case 3:return t=e.sent,e.next=6,t.json();case 6:(a=e.sent)&&a.length>0&&(this.api_endpoints=a),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"load_default",value:function(){var e=Object(V.a)(F.a.mark((function e(){var t,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("default.json");case 3:return t=e.sent,e.next=6,t.json();case 6:(a=e.sent).app_name&&(this.appname=a.app_name),a.api_key&&(this._chat_key=a.api_key),a.api_url&&(this._chat_api_url=a.api_url),a.chat_model&&(this._chat_model=a.chat_model),a.chat_max_tokens&&(this._chat_max_tokens=a.chat_max_tokens),a.chat_temperature&&(this._chat_temperature=a.chat_temperature),a.chat_timeout&&(this._chat_timeout=a.chat_timeout),a.chat_system_prompt&&(this._chat_system_prompt=a.chat_system_prompt),a.chat_user_prompt&&(this._chat_user_prompt=a.chat_user_prompt),a.chat_character_url&&(this._chat_avatar_url=a.chat_character_url),a.chat_character_opacity&&(this._chat_opacity=a.chat_character_opacity),a.chat_moderation&&(this._chat_moderation_on="on"==a.chat_moderation),e.next=23;break;case 21:e.prev=21,e.t0=e.catch(0);case 23:case"end":return e.stop()}}),e,this,[[0,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"load_vars",value:function(){var e=Object(V.a)(F.a.mark((function e(){var t=this;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load_default();case 2:this.to_save_vars.forEach((function(e){var a=window.localStorage.getItem("FT_CHATCHAN_VAR_"+e);a&&(t[e]=JSON.parse(a))}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"save_vars",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=null===t?this.to_save_vars:[t];a.forEach((function(t){window.localStorage.setItem("FT_CHATCHAN_VAR_"+t,JSON.stringify(e[t]))}))}},{key:"get_wechat_login_url",value:function(){var e=Object(V.a)(F.a.mark((function e(){var t,a,r,n=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.ftopenapp_id,a=n.length>1&&void 0!==n[1]?n[1]:this.session,e.next=4,this.api.get("global/user/get_wx_sns_login_url?id="+t+"&session="+a);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get_token_by_code",value:function(){var e=Object(V.a)(F.a.mark((function e(t){var a,r,n=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.length>1&&void 0!==n[1]?n[1]:"",e.next=3,this.api.post("global/user/get_token_by_wx_code",{code:t,session:a});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"preorder",value:function(){var e=Object(V.a)(F.a.mark((function e(t){var a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("global/pay/order",{amount_cent:t});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.user=null,this.token=null,window.localStorage.clear()}},{key:"set_user",value:function(e){this.user=e,this.token=e.session_id,this.save_vars()}},{key:"check_user_info",value:function(){var e=Object(V.a)(F.a.mark((function e(){var t,a,r,n=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=n.length>0&&void 0!==n[0]?n[0]:null)){e.next=8;break}return e.next=4,this.api.post("global/user/get_user_session",{token:t},!1);case 4:return a=e.sent,e.abrupt("return",a);case 8:return e.next=10,this.api.post("global/user/get_user_session");case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get_user_profile",value:function(){var e=Object(V.a)(F.a.mark((function e(){var t;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("global/user/profile");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),n=Object(Y.a)(r.prototype,"appname",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NAME||"Chat\u9171"}}),s=Object(Y.a)(r.prototype,"apibase",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"https://openapi.ftqq.com/"}}),o=Object(Y.a)(r.prototype,"local_apibase",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),i=Object(Y.a)(r.prototype,"session",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),c=Object(Y.a)(r.prototype,"token",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_=Object(Y.a)(r.prototype,"user",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),p=Object(Y.a)(r.prototype,"api_endpoints",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=Object(Y.a)(r.prototype,"menu",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[{id:8001,text:"\u9996\u9875",link:"/home",member_only:!1}]}}),Object(Y.a)(r.prototype,"logout",[J.f],Object.getOwnPropertyDescriptor(r.prototype,"logout"),r.prototype),Object(Y.a)(r.prototype,"set_user",[J.f],Object.getOwnPropertyDescriptor(r.prototype,"set_user"),r.prototype),u=Object(Y.a)(r.prototype,"coin_name",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"\u91d1\u5e01"}}),A=Object(Y.a)(r.prototype,"recharge_input_coin",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),T=Object(Y.a)(r.prototype,"_donate_keys",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),h=Object(Y.a)(r.prototype,"_donate_title",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),E=Object(Y.a)(r.prototype,"_donate_link",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),P=Object(Y.a)(r.prototype,"_chat_model",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"gpt-3.5-turbo"}}),m=Object(Y.a)(r.prototype,"_chat_saved_list",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),O=Object(Y.a)(r.prototype,"_preset_saved_list",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=Object(Y.a)(r.prototype,"_chat_key",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_DEFAULT_VALUE||""}}),b=Object(Y.a)(r.prototype,"_chat_api_url",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_API_URL||"https://api.openai.com"}}),f=Object(Y.a)(r.prototype,"_chat_avatar_url",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),C=Object(Y.a)(r.prototype,"_chat_bg_url",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),y=Object(Y.a)(r.prototype,"_chat_max_tokens",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),N=Object(Y.a)(r.prototype,"_chat_temperature",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),v=Object(Y.a)(r.prototype,"_chat_timeout",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),I=Object(Y.a)(r.prototype,"_chat_system_prompt",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),S=Object(Y.a)(r.prototype,"_chat_user_prompt",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),R=Object(Y.a)(r.prototype,"_chat_char_opacity",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),k=Object(Y.a)(r.prototype,"_chat_history_count",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 6}}),g=Object(Y.a)(r.prototype,"_chat_last",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=Object(Y.a)(r.prototype,"_chat_auto_save",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"yes"}}),B=Object(Y.a)(r.prototype,"_chat_summarize_content",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"yes"}}),x=Object(Y.a)(r.prototype,"_chat_auto_audio",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"no"}}),w=Object(Y.a)(r.prototype,"_chat_pin_window",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"no"}}),U=Object(Y.a)(r.prototype,"_preset_system_prompt",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),L=Object(Y.a)(r.prototype,"_preset_user_prompt",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),D=Object(Y.a)(r.prototype,"_preset_prompt_title",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),G=Object(Y.a)(r.prototype,"_preset_prompt_id",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),q=Object(Y.a)(r.prototype,"_chat_moderation_on",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),K=Object(Y.a)(r.prototype,"_chat_stream",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"yes"}}),W=Object(Y.a)(r.prototype,"_chat_change_model",[J.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"yes"}}),r);t.a=new te},304:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return B}));var r,n,s=a(14),o=a(3),i=a.n(o),c=a(6),_=a(11),p=a(12),l=a(15),u=a(16),A=a(0),T=a.n(A),h=a(8),E=a(41),P=a(52),m=a(17),O=a(23),d=(a(1143),a(488)),b=a(471),f=a(60),C=a(145),y=a(305),N=a(480),v=a(124),I=a(174),S=a(481),R=a.n(S),k=a(235),g=a(485),j=a(224),B=(r=Object(h.b)("store"),Object(E.f)(n=r(n=Object(h.c)(n=function(t){Object(l.a)(n,t);var r=Object(u.a)(n);function n(e){var t;return Object(_.a)(this,n),(t=r.call(this,e)).handleFile=function(e){var a=e.target.files[0];if("application/json"===a.type){var r=new FileReader;r.onload=function(e){var a=JSON.parse(e.target.result);if(a&&a.chat_list){for(var r=t.props.store._chat_saved_list,n=a.chat_list,s=[],o=0;o<n.length;o++){for(var i=!1,c=0;c<r.length;c++)if(r[c].id==n[o].id){i=!0;break}i||s.push(n[o])}t.props.store._chat_saved_list=r.concat(s),t.props.store.save_vars("_chat_saved_list")}if(a&&a.preset_list){for(var _=t.props.store._preset_saved_list,p=a.preset_list,l=[],u=0;u<p.length;u++){for(var A=!1,T=0;T<_.length;T++)if(_[T].id==p[u].id){A=!0;break}A||l.push(p[u])}t.props.store._preset_saved_list=_.concat(l),t.props.store.save_vars("_preset_saved_list")}},r.readAsText(a)}else alert("Please select a JSON file")},t.inputRef=T.a.createRef(),t.state={actions:{},list:[],text:"",last:!1,loading:!1,typing:"",force_cn:!1,connect:!1,show_tips:!1,in:!1,saved_list:{},settings_open:!1,avatar_open:!1,show_undo:!1,point:"-",show_extend_settings:!1,snap:!1,tab_selected:"history",prompt_box:!1},t}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.init(),this.audio_to_play=[],window.location.hostname.match(/ftqq.com$/)&&this.setState({in:!0}),document.addEventListener("keydown",(function(t){var a;13===t.keyCode&&(t.metaKey||t.ctrlKey)&&e.send(null===(a=e.state.text)||void 0===a?void 0:a.trim())})),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight,window.setTimeout((function(){var t;(e.props.store._chat_key&&e.props.store._chat_key.length>10&&e.refresh_point(),e.state.list.length<1&&e.props.store._chat_last&&e.props.store._chat_last.length>0&&e.setState({list:e.props.store._chat_last}),"yes"==e.props.store._chat_pin_window)&&(window&&window.electronAPI&&(null===(t=window.electronAPI)||void 0===t?void 0:t.pinWindow)&&(window.electronAPI.pinWindow(!0),console.log("set window float")));e.check_bottom_effect()}),1e3),document.addEventListener("visibilitychange",(function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}))}},{key:"init",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.e(3).then(a.bind(null,1466));case 3:this.tiktoken=e.sent,e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("wasm\u8f7d\u5165\u9519\u8bef",e.t0),Object(O.b)("wasm\u8f7d\u5165\u5931\u8d25\uff0c\u8fdb\u5165\u517c\u5bb9\u6a21\u5f0f\uff0c\u5982\u9047400\u9519\u8bef\uff0c\u8bf7\u6e05\u7406\u5bf9\u8bdd\u8bb0\u5f55");case 10:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"onChange",value:function(e,t){this.setState(Object(s.a)({},t,e.target.value))}},{key:"save_key",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.props.store._chat_key.length<10)){e.next=3;break}return Object(O.b)("\u8bf7\u8f93\u5165\u6b63\u786e\u7684OpenAPI/API2D Key"),e.abrupt("return",!1);case 3:this.props.store.save_vars(),this.api2d_instance=null,Object(O.b)("\u4fdd\u5b58\u6210\u529f");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clean_conversation",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(a.length>0&&void 0!==a[0])||a[0],"yes"!=this.props.store._chat_auto_save||!t){e.next=4;break}return e.next=4,this.save_conversation();case 4:this.old_list=this.state.list.slice(),this.setState({last:!1,list:[],loading:!1,show_undo:!0}),this.props.store._chat_last=[],this.props.store.save_vars("_chat_last"),Object(O.b)("\u5bf9\u8bdd\u5df2\u6e05\u9664\uff0c\u53ef\u70b9\u6062\u590d\u6309\u94ae\u64a4\u9500"),console.log("this.props.store._chat_change_model",this.props.store._chat_change_model,"this.props.store._chat_model",this.props.store._chat_model),"gpt-3.5-turbo-16k"===this.props.store._chat_model&&"yes"===this.props.store._chat_change_model&&(this.props.store._chat_model="gpt-3.5-turbo");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"undo_conversation",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.old_list&&(this.setState({last:!1,list:this.old_list,loading:!1,show_undo:!1}),window.setTimeout((function(){document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight}),300));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"remove_list",value:function(){var e=Object(c.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.store._chat_saved_list=this.props.store._chat_saved_list.filter((function(e){return e.id!=t})),this.props.store.save_vars(),this.check_bottom_effect();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rename_conversation",value:function(){var e=Object(c.a)(i.a.mark((function e(t,a){var r,n,s,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getApiInstance(),e.prev=1,a=a.replace(/@[\s\S]*?\s/g,"").replace(/#[\s\S]*?\s/g,"").substring(0,800),e.next=5,r.completion({messages:[{role:"system",content:"\u4f60\u662f\u4e00\u4e2a\u7ecf\u9a8c\u4e30\u5bcc\u7684\u8bb0\u5f55\u5458\uff0c\u64c5\u957f\u4ece\u5bf9\u8bdd\u4e2d\u63d0\u53d6\u5173\u952e\u4fe1\u606f\uff0c\u5e76\u4e3a\u5bf9\u8bdd\u547d\u540d\u3002"},{role:"user",content:"\u8bf7\u4e3a\u4ee5\u4e0b\u5bf9\u8bdd\u547d\u540d\uff0c\u4f18\u5148\u4f7f\u7528\u4e2d\u6587\uff0c\u76f4\u63a5\u8fd4\u56de\u540d\u79f0\uff0c\u957f\u5ea6\u5c3d\u91cf\u572830\u4e2a\u5b57\u4ee5\u5185\u3002\u5bf9\u8bdd\u5185\u5bb9\uff1a"+a+"\n\u5bf9\u8bdd\u547d\u540d\uff1a"}],temperature:0,max_tokens:50,model:"gpt-3.5-turbo",stream:!1});case 5:n=e.sent,console.log(n),n&&n.choices&&n.choices.length>0&&((o=null===(s=n.choices[0].message)||void 0===s?void 0:s.content).length>30&&(o=o.substring(0,30)),this.props.store._chat_saved_list=this.props.store._chat_saved_list.map((function(e){return e.id==t&&(e.name=o),e})),this.props.store.save_vars("_chat_saved_list")),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"save_conversation",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.list.length<1)){e.next=2;break}return e.abrupt("return",!1);case 2:t=this.state.list[0].text.substring(0,10)+"-"+(new Date).getTime(),a=(new Date).getTime(),console.log("conversation_id",a),r=this.state.list.map((function(e){return e.text})).join("\n"),this.props.store._chat_saved_list.length>100&&this.props.store._chat_saved_list.shift(),this.props.store._chat_saved_list.push({name:t,list:this.state.list,id:a}),this.props.store.save_vars(),Object(O.b)("\u5bf9\u8bdd\u5df2\u4fdd\u5b58\uff0c\u53ef\u5728\u300c\u5bf9\u8bdd\u8bb0\u5f55\u300d\u4e2d\u67e5\u770b"),this.check_bottom_effect(),"yes"==this.props.store._chat_summarize_content&&this.rename_conversation(a,r.substring(0,800));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getApiInstance",value:function(){return this.api2d_instance||(this.api2d_instance=new d.a(this.props.store._chat_key,this.props.store._chat_api_url)),this.api2d_instance}},{key:"regen_conversation",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,r,n,s,o,c,_,p,l,u,A,T,h,E,P,m,d,b=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({list:this.state.list.slice(0,-1)}),t=[],a=0,r=this.state.list.length-2;case 4:if(!(r>=0)){e.next=12;break}if(t.unshift(this.state.list[r]),!(++a>=this.props.store._chat_history_count)){e.next=9;break}return e.abrupt("break",12);case 9:r--,e.next=4;break;case 12:console.log("new_list",JSON.stringify(t)),n=[],s=0,o=0;case 16:if(!(o<t.length)){e.next=27;break}if(!(s+t[o].text.length>this.props.store._chat_max_tokens)){e.next=19;break}return e.abrupt("break",27);case 19:"me"==(c=t[o].role)&&(c="user"),"robot"==c&&(c="assistant"),_={role:c,content:t[o].text},n.push(_);case 24:o++,e.next=16;break;case 27:return console.log("history",JSON.stringify(n)),e.prev=28,u=this.getApiInstance(),e.next=32,u.completion({messages:n,temperature:null!==(p=parseFloat(this.props.store._chat_temperature))&&void 0!==p?p:0,max_tokens:null!==(l=parseInt(this.props.store._chat_max_tokens))&&void 0!==l?l:1e3,model:this.props.store._chat_model||"gpt-3.5-turbo",stream:"yes"==this.props.store._chat_stream,moderation:this.props.store._chat_key.startsWith("fk")&&this.props.store._chat_moderation,moderation_stop:!0,noCache:this.props.store._chat_key.startsWith("fk"),onMessage:function(e){console.log("onMessage",e),b.setState({typing:e}),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight},onEnd:function(e){b.setState({typing:""}),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight}});case 32:A=e.sent,console.log("ret",A),A&&(this.setState({list:this.state.list.concat({text:"yes"==this.props.store._chat_stream?A.trim():null===(T=A.choices[0])||void 0===T||null===(h=T.message)||void 0===h?void 0:h.content.trim(),role:"robot"}),text:"",loading:!1}),this.props.store._chat_last=this.state.list,this.props.store.save_vars("_chat_last")),e.next=59;break;case 37:e.prev=37,e.t0=e.catch(28),P=e.t0.message,m=null===(E=P.match(/\[(\d+)\]/))||void 0===E?void 0:E[1],d=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_NAME||"KEY",e.t1=m,e.next="400"===e.t1?45:"401"===e.t1?47:"402"===e.t1?49:"403"===e.t1?51:"408"===e.t1?53:"429"===e.t1?55:57;break;case 45:return P="\u8bf7\u6c42\u53c2\u6570\u9519\u8bef\uff0c\u5386\u53f2\u8bb0\u5f55\u53ef\u80fd\u8fc7\u957f\uff0c\u8bf7\u6e05\u7406\u540e\u518d\u8bd5",e.abrupt("break",57);case 47:return P="".concat(d,"\u9519\u8bef\u6216\u8005\u8d26\u6237\u72b6\u6001\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\uff1a").concat(d,"\u662f\u5426\u6b63\u786e\u3001").concat(d,"\u662f\u5426\u88ab\u7981\u7528"),e.abrupt("break",57);case 49:return P=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NO_MORE_POINT_TEXT||"\u8d26\u6237\u70b9\u6570\u4e0d\u8db3\uff0c\u8bf7\u5145\u503c\u3002Api2d \u6309\u8bbe\u7f6e\u4e2d\u7684 Max token \u8fdb\u884c\u9884\u6263\uff0c\u56e0\u6b64\u5e76\u4e0d\u662f\u70b9\u6570\u5927\u4e8e\u96f6\u5c31\u53ef\u4ee5\u4f7f\u7528\u3002",e.abrupt("break",57);case 51:return P="\u8bf7\u6c42\u7684\u6a21\u578b\u6216\u8005\u8def\u5f84\u4e0d\u53ef\u7528\u6216\u672a\u5f00\u653e\uff0c\u8bf7\u68c0\u67e5\uff1a\u6a21\u578b\u662f\u5426\u5b58\u5728\u3001\u6a21\u578b\u662f\u5426\u88ab\u7981\u7528",e.abrupt("break",57);case 53:return P="\u8bf7\u6c42\u8d85\u65f6\uff0c\u53ef\u8c03\u6574\u5ba2\u6237\u7aef\u8bbe\u7f6e\uff1b\u670d\u52a1\u5668\u7aef\u6700\u957f\u54cd\u5e94\u65f6\u95f4\u4e3a180\u79d2",e.abrupt("break",57);case 55:return P="\u8bf7\u6c42\u8fc7\u4e8e\u9891\u7e41\uff0c\u6216\u8005\u670d\u52a1\u5668\u8fde\u63a5\u8fc7\u591a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",e.abrupt("break",57);case 57:Object(O.b)("\u9519\u8bef\uff1a"+P),this.setState({loading:!1,typing:""});case 59:this.refresh_point();case 60:case"end":return e.stop()}}),e,this,[[28,37]])})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var a,r,n,s,o,c,_,p,l,u,A,T,h,E,P,m,d,b,f,C,y,N,v,I,S,R,k,g=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.props.store._chat_key.length<10)){e.next=3;break}return Object(O.b)("\u8bf7\u5148\u70b9\u51fb\u53f3\u4e0a\u89d2\u6309\u94ae\u8bbe\u7f6e".concat(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_NAME||"KEY","\u4ee5\u540e\u518d\u4f7f\u7528")),e.abrupt("return",!1);case 3:if(!Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_CK_ID){e.next=17;break}a=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_CK_ID.split("|"),r=!1,n=0;case 7:if(!(n<a.length)){e.next=14;break}if(!(this.props.store._chat_key.indexOf("|".concat(a[n].toLowerCase()))>0)){e.next=11;break}return r=!0,e.abrupt("break",14);case 11:n++,e.next=7;break;case 14:if(r){e.next=17;break}return Object(O.b)("\u60a8\u7684Key\u4e0d\u80fd\u5728\u6b64\u4f7f\u7528\uff0c\u8bf7\u54a8\u8be2Key\u7684\u4f9b\u5e94\u5546"),e.abrupt("return",!1);case 17:if(console.log("on send"),!(t.length<1)){e.next=20;break}return e.abrupt("return",!1);case 20:if(!this.state.loading){e.next=22;break}return e.abrupt("return",!1);case 22:for(document.querySelector(".input-box").style.height="100px",s=this.state.list.concat({text:t,role:"me"}),this.setState({loading:!0,typing:"\u6b63\u5728\u601d\u8003\u4e2d...",list:s,show_undo:!1}),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight,e.prev=26,(o=this.getApiInstance()).setApiBaseUrl(this.props.store._chat_api_url),parseInt(this.props.store._chat_timeout)>0&&(o.timeout=1e3*parseInt(this.props.store._chat_timeout)),c=-2-parseInt(this.props.store._chat_history_count||6),_=c<0?s.slice(c):[],console.log("old",_),p=[],this.props.store._chat_system_prompt&&p.push({role:"system",content:this.props.store._chat_system_prompt}),this.props.store._chat_user_prompt&&p.push({role:"user",content:this.props.store._chat_user_prompt}),l=0;l<_.length;l++)"me"==_[l].role?p.push({role:"user",content:_[l].text}):p.push({role:"assistant",content:_[l].text});if(0!=p.length){e.next=40;break}return Object(O.b)("\u8bb0\u5f55\u4e3a\u7a7a"),e.abrupt("return",!1);case 40:if(!this.tiktoken){e.next=89;break}if(!(u=this.tiktoken.encoding_for_model)||"object"!==typeof WebAssembly||"function"!==typeof WebAssembly.instantiate){e.next=88;break}console.log("encoding_for_model & wasm enabled"),A=this.props.store._chat_model,e.t0=A,e.next="gpt-3.5-turbo-16k"===e.t0||"gtp-3.5-turbo-0613"===e.t0?48:"gpt-4-0613"===e.t0?50:52;break;case 48:return A="gpt-3.5-turbo",e.abrupt("break",52);case 50:return A="gpt-4",e.abrupt("break",52);case 52:T=u(A),h=p,E=0;case 55:if(!(E<h.length)){e.next=63;break}if(!(!h[E]||"object"!==typeof h[E]||!h[E].content||h[E].content.length<1||!h[E].role||h[E].role.length<1)){e.next=59;break}return Object(O.b)("\u8bb0\u5f55\u683c\u5f0f\u9519\u8bef"),e.abrupt("return",!1);case 59:case 60:E++,e.next=55;break;case 63:P=h.map((function(e){return"<|im_start|>".concat(e.role," \n").concat(e.content,"<|im_end|>\n")})).join("")+"<|im_start|>assistant \n",console.log("wrapped",P),P=P.replaceAll("<|im_start|>"," , ").replaceAll("<|im_end|>"," , ").trim(),m=T.encode(P).length,console.log("message_tokens",m),d=4096,e.t1=this.props.store._chat_model,e.next="gpt-3.5-turbo"===e.t1?72:"gpt-4"===e.t1?74:"gpt-3.5-turbo-16k"===e.t1?76:78;break;case 72:return d=4096,e.abrupt("break",78);case 74:return d=8192,e.abrupt("break",78);case 76:return d=16384,e.abrupt("break",78);case 78:if(!(m+parseInt(this.props.store._chat_max_tokens)>=d)){e.next=86;break}if("yes"!=this.props.store._chat_change_model){e.next=83;break}"gpt-3.5-turbo"==this.props.store._chat_model&&(this.props.store._chat_model="gpt-3.5-turbo-16k",d=16384,Object(O.b)("\u5185\u5bb9\u8fc7\u957f\uff0c\u81ea\u52a8\u8c03\u6574\u4e3a gpt-3.5-16k \u6a21\u578b")),e.next=86;break;case 83:return Object(O.b)("\u8f93\u5165\u5185\u5bb9\u8fc7\u957f\uff0c\u8bf7\u6e05\u7406\u5bf9\u8bdd\u5386\u53f2\u6216\u8005\u51cf\u5c11\u6700\u5927token"),this.setState({loading:!1,typing:""}),e.abrupt("return",!1);case 86:e.next=89;break;case 88:console.log("load encoding fail");case 89:return e.prev=89,C="",e.next=93,o.completion({messages:p,temperature:null!==(b=parseFloat(this.props.store._chat_temperature))&&void 0!==b?b:0,max_tokens:null!==(f=parseInt(this.props.store._chat_max_tokens))&&void 0!==f?f:1e3,model:this.props.store._chat_model||"gpt-3.5-turbo",stream:"yes"==this.props.store._chat_stream,moderation:this.props.store._chat_key.startsWith("fk")&&this.props.store._chat_moderation_on,moderation_stop:!0,onMessage:function(e,t){if(console.log("text",e,"last",t),e.length<1)return!1;if(t&&(C+=t,"\u3002"===t||"\uff01"===t||"\uff1f"===t)){var a=C;C="","yes"==g.props.store._chat_auto_audio&&a.length>1&&g.audio(a)}g.setState({typing:e}),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight},onEnd:function(e){g.setState({typing:""}),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight,"yes"==g.props.store._chat_auto_audio&&C.length>1&&g.audio(C)}});case 93:(y=e.sent)&&(console.log("send ret",y),this.setState({list:this.state.list.concat({text:"yes"==this.props.store._chat_stream?y.trim():null===(N=y.choices[0])||void 0===N||null===(v=N.message)||void 0===v?void 0:v.content.trim(),role:"robot"}),text:"",typing:"",loading:!1}),this.props.store._chat_last=this.state.list,this.props.store.save_vars("_chat_last")),e.next=119;break;case 97:e.prev=97,e.t2=e.catch(89),S=e.t2.message,R=null===(I=S.match(/\[(\d+)\]/))||void 0===I?void 0:I[1],k=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_NAME||"KEY",e.t3=R,e.next="400"===e.t3?105:"401"===e.t3?107:"402"===e.t3?109:"403"===e.t3?111:"408"===e.t3?113:"429"===e.t3?115:117;break;case 105:return S="\u8bf7\u6c42\u53c2\u6570\u9519\u8bef\uff0c\u5386\u53f2\u8bb0\u5f55\u53ef\u80fd\u8fc7\u957f\uff0c\u8bf7\u6e05\u7406\u540e\u518d\u8bd5",e.abrupt("break",117);case 107:return S="".concat(k,"\u9519\u8bef\u6216\u8005\u8d26\u6237\u72b6\u6001\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\uff1a").concat(k,"\u662f\u5426\u6b63\u786e\u3001").concat(k,"\u662f\u5426\u88ab\u7981\u7528"),e.abrupt("break",117);case 109:return S=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NO_MORE_POINT_TEXT||"\u8d26\u6237\u70b9\u6570\u4e0d\u8db3\uff0c\u8bf7\u5145\u503c\u3002Api2d \u6309\u8bbe\u7f6e\u4e2d\u7684 Max token \u8fdb\u884c\u9884\u6263\uff0c\u56e0\u6b64\u5e76\u4e0d\u662f\u70b9\u6570\u5927\u4e8e\u96f6\u5c31\u53ef\u4ee5\u4f7f\u7528\u3002",e.abrupt("break",117);case 111:return S="\u8bf7\u6c42\u7684\u6a21\u578b\u6216\u8005\u8def\u5f84\u4e0d\u53ef\u7528\u6216\u672a\u5f00\u653e\uff0c\u8bf7\u68c0\u67e5\uff1a\u6a21\u578b\u662f\u5426\u5b58\u5728\u3001\u6a21\u578b\u662f\u5426\u88ab\u7981\u7528",e.abrupt("break",117);case 113:return S="\u8bf7\u6c42\u8d85\u65f6\uff0c\u53ef\u8c03\u6574\u5ba2\u6237\u7aef\u8bbe\u7f6e\uff1b\u670d\u52a1\u5668\u7aef\u6700\u957f\u54cd\u5e94\u65f6\u95f4\u4e3a180\u79d2",e.abrupt("break",117);case 115:return S="\u8bf7\u6c42\u8fc7\u4e8e\u9891\u7e41\uff0c\u6216\u8005\u670d\u52a1\u5668\u8fde\u63a5\u8fc7\u591a\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",e.abrupt("break",117);case 117:Object(O.b)("\u9519\u8bef\uff1a"+S),this.setState({loading:!1,typing:""});case 119:document.querySelector(".input-box").focus(),document.querySelector(".chat-list").scrollTop=document.querySelector(".chat-list").scrollHeight,window.setTimeout((function(){g.refresh_point()}),1e3),e.next=129;break;case 124:e.prev=124,e.t4=e.catch(26),console.log("error",e.t4),Object(O.b)("\u53d1\u9001\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5".concat(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_NAME||"KEY","\u548cAPI\u8bf7\u6c42\u5730\u5740\u662f\u5426\u6b63\u786e\u6216\u91cd\u8bd5\u3002")+JSON.stringify(e.t4)),this.setState({loading:!1});case 129:case"end":return e.stop()}}),e,this,[[26,124],[89,97]])})));return function(t){return e.apply(this,arguments)}}()},{key:"warning",value:function(e){"gpt-4"==e&&Object(O.b)("4\u6a21\u578b\u4ef7\u683c\u662f3.5\u768415~30\u500d\uff0c\u4e14\u8fd4\u56de\u8f83\u6162\u5bb9\u6613\u8d85\u65f6\uff0c\u8bf7\u8c28\u614e\u4f7f\u7528\u3002"),this.props.store.save_vars("_chat_model")}},{key:"select_action",value:function(){var e=Object(c.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.actions[t.target.value]&&this.send(this.state.actions[t.target.value]);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,r,n,s=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"history"==(s.length>0&&void 0!==s[0]?s[0]:"history")?(t=JSON.stringify({chat_list:this.props.store._chat_saved_list}),a=new Blob([t],{type:"application/json"}),Object(k.saveAs)(a,"".concat(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NAME||"Chat\u9171",".\u5bf9\u8bdd\u8bb0\u5f55.json"))):(r=JSON.stringify({preset_list:this.props.store._preset_saved_list}),n=new Blob([r],{type:"application/json"}),Object(k.saveAs)(n,"".concat(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NAME||"Chat\u9171",".\u5e38\u7528\u63d0\u793a\u8bcd.json")));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"check_bottom_effect",value:function(){if(!document.querySelector(".history-list"))return!1;console.log("check_bottom_effect"),document.querySelector(".history-list").scrollHeight>document.querySelector(".history-list").clientHeight?(console.log("\u6709\u6eda\u52a8\u6761"),document.querySelector(".bottom-effect").style.display="block",document.querySelector(".bottom-effect").style.bottom="0"):(document.querySelector(".bottom-effect").style.display="none",console.log("\u6ca1\u6709\u6eda\u52a8\u6761"))}},{key:"set_text",value:function(){var e=Object(c.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({text:this.state.text+" "+t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"donate",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.history.push("/donate");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load_list",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.old_list=this.state.list,a=JSON.parse(t),this.setState({list:a,show_undo:!0}),this.props.store.save_vars("_chat_last"),Object(O.b)("\u5df2\u8f7d\u5165\u5386\u53f2\u4f1a\u8bdd\u8bb0\u5f55\uff0c\u53ef\u70b9\u51fb\u5bf9\u8bdd\u6700\u4e0a\u65b9\u7684\u64a4\u9500\u6309\u94ae\u6062\u590d\u539f\u6709\u5bf9\u8bdd");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refresh_point",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.store._chat_api_url&&this.props.store._chat_key&&this.props.store._chat_key.startsWith("fk")){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,(t=this.getApiInstance()).setApiBaseUrl(this.props.store._chat_api_url),e.next=7,t.billing();case 7:(a=e.sent)&&(a.object&&"error"==a.object&&Object(O.b)("\u83b7\u53d6\u70b9\u6570\u5931\u8d25\uff1a"+a.message),a.total_available&&(r=a.total_available*(parseFloat(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_POINT_SCALE)||1),Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_POINT_DECIMAL&&(r=r.toFixed(parseInt(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_POINT_DECIMAL)||0)),this.setState({point:r}))),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),console.log("error",e.t0),this.api2d_instance=null,Object(O.b)("\u83b7\u53d6\u70b9\u6570\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u8bf7\u6c42\u5730\u5740\u548cKey\uff1a"+e.t0.message);case 16:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.store._chat_key=this.props.store._chat_key.trim(),this.props.store._chat_api_url=this.props.store._chat_api_url.trim(),(!this.props.store._chat_api_url||this.props.store._chat_key.startsWith("fk")&&this.props.store._chat_api_url.startsWith("https://api.openai.com"))&&(this.props.store._chat_api_url="https://oa.api2d.net",Object(O.b)("\u68c0\u6d4b\u5230\u60a8\u4f7f\u7528\u7684\u662fForward Key\uff0c\u5df2\u81ea\u52a8\u5207\u6362API\u5730\u5740")),t=4096,e.t0=this.props.store._chat_model,e.next="gpt-3.5-turbo"===e.t0?7:"gpt-4"===e.t0?9:"gpt-3.5-turbo-16k"===e.t0?11:13;break;case 7:return t=4096,e.abrupt("break",13);case 9:return t=8192,e.abrupt("break",13);case 11:return t=16384,e.abrupt("break",13);case 13:if(!(this.props.store._chat_max_tokens>t-10)){e.next=16;break}return Object(O.b)("\u5f53\u524d\u6a21\u578b\u6700\u5927tokens\u4e3a"+t+"\uff0c\u60a8\u8bbe\u7f6e\u7684max tokens\u592a\u5927\uff0c\u65e0\u6cd5\u6b63\u5e38\u804a\u5929\uff0c\u8bf7\u91cd\u65b0\u8bbe\u7f6e"),e.abrupt("return",!1);case 16:return this.props.store.save_vars(),this.api2d_instance=null,e.next=20,this.refresh_point();case 20:this.setState({settings_open:!1});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avatar_save",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.store.save_vars(),this.setState({avatar_open:!1});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"abort",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getApiInstance().abort(),this.api2d_instance=null,t=this.state.typing,this.setState({loading:!1,typing:"",list:this.state.list.concat({text:t+"...",role:"robot"})});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"export_conversation",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,r,n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({snap:!0}),(t=document.querySelector("#snap_tmp"))||(t=document.createElement("div"),a=document.querySelector(".chat-list"),r=a.offsetWidth||720,t.style.width="".concat(r,"px"),t.style.padding="20px",t.setAttribute("id","snap_tmp"),t.classList.add("snap-chat-list"),document.body.appendChild(t)),window.setTimeout(Object(c.a)(i.a.mark((function e(){var a,r,s,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.innerHTML=document.querySelector(".chat-list").innerHTML,a=t.querySelectorAll(".bp3-button.code-copy"),r=0;r<a.length;r++)a[r].style.display="none";return e.next=5,R()(document.querySelector("#snap_tmp"),{scale:2});case 5:s=e.sent,n.setState({snap:!1}),o=Date.now(),Object(k.saveAs)(s.toDataURL(),"".concat(n.props.store.appname||"Chat\u9171","-")+o+".png"),document.querySelector("#snap_tmp").remove();case 10:case"end":return e.stop()}}),e)}))),500);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prompt_add",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({prompt_box:!0});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prompt_save",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.store._preset_prompt_title){e.next=3;break}return Object(O.b)("\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a"),e.abrupt("return",!1);case 3:if(this.props.store._preset_system_prompt||this.props.store._preset_user_prompt){e.next=6;break}return Object(O.b)("\u63d0\u793a\u8bcd\u4e0d\u80fd\u90fd\u4e3a\u7a7a"),e.abrupt("return",!1);case 6:this.props.store._preset_prompt_id?((a=this.props.store._preset_saved_list.find((function(e){return e.id==r.props.store._preset_prompt_id}))).title=this.props.store._preset_prompt_title,a.system=this.props.store._preset_system_prompt,a.user=this.props.store._preset_user_prompt,this.props.store.save_vars("_preset_saved_list"),this.prompt_box_clean(!0)):(t={id:Date.now(),title:this.props.store._preset_prompt_title,system:this.props.store._preset_system_prompt,user:this.props.store._preset_user_prompt},this.props.store._preset_saved_list.push(t),this.props.store.save_vars("_preset_saved_list"),this.prompt_box_clean(!0));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prompt_box_clean",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.store._preset_prompt_title="",this.props.store._preset_system_prompt="",this.props.store._preset_user_prompt="",this.props.store._preset_prompt_id="",e&&this.setState({prompt_box:!1})}},{key:"load_prompt",value:function(e){var t=this.props.store._preset_saved_list.find((function(t){return t.id==e})),a=this.inputRef.current,r=a.selectionStart,n=a.selectionEnd,s=this.state.text.substring(0,r)+t.user+this.state.text.substring(n);this.setState({text:s}),setTimeout((function(){a.selectionStart=r+t.user.length,a.selectionEnd=r+t.user.length,a.focus()}),0)}},{key:"edit_prompt",value:function(e){var t=this.props.store._preset_saved_list.find((function(t){return t.id==e}));this.props.store._preset_prompt_id=e,this.props.store._preset_prompt_title=t.title,this.props.store._preset_system_prompt=t.system,this.props.store._preset_user_prompt=t.user,this.setState({prompt_box:!0})}},{key:"remove_prompt",value:function(e){var t=this.props.store._preset_saved_list.findIndex((function(t){return t.id==e}));this.props.store._preset_saved_list.splice(t,1),this.props.store.save_vars("_preset_saved_list")}},{key:"remove_chat_line",value:function(e){var t=this;this.old_list=this.state.list;var a=this.state.list.filter((function(t,a){return a!=e}));this.setState({list:a,show_undo:!0}),window.setTimeout((function(){t.props.store._chat_last=t.state.list,t.props.store.save_vars("_chat_last")}),1e3)}},{key:"audio_play",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a,r,n,s,o=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.playing){e.next=2;break}return e.abrupt("return",!1);case 2:if(this.audio_to_play.length){e.next=4;break}return e.abrupt("return",!1);case 4:return this.playing=!0,t=this.audio_to_play.shift(),a=t.text,r=this.getApiInstance(),e.next=9,r.textToSpeech({text:a,voiceName:"zh-CN-XiaoxiaoNeural",responseType:"blob-url",speed:1.2});case 9:n=e.sent,s=n,console.log("shift",s,a),this.audio_dom||(this.audio_dom=new Audio),this.audio_dom.src=s,this.audio_dom.play(),this.audio_dom.addEventListener("ended",(function(){URL.revokeObjectURL(s),o.playing=!1,o.audio_play()}),{once:!0});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"audio",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var a,r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0==this.props.store._chat_key.indexOf("fk")){e.next=3;break}return Object(O.b)("\u53ea\u6709API2D\u7684Key\u53ef\u652f\u6301\u8bed\u97f3"),e.abrupt("return",!1);case 3:return e.t0=String,e.next=6,Object(g.a)().process(t);case 6:e.t1=e.sent,a=(0,e.t0)(e.t1),(r=document.createElement("div")).innerHTML=a,n=r.innerText,r.remove(),console.log("markdown to text",t,n),n.length>1&&(this.audio_to_play.push({text:n}),this.audio_play());case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toggle_version",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="gpt-3.5-turbo","gpt-3.5-turbo"==this.props.store._chat_model&&(t="gpt-3.5-turbo-16k"),"gpt-3.5-turbo-16k"==this.props.store._chat_model&&(t="gpt-4"),"gpt-4"==this.props.store._chat_model&&(t="gpt-3.5-turbo"),this.props.store._chat_model=t,this.props.store.save_vars("_chat_model");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeApiEndpoint",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.store.api_endpoints&&this.props.store.api_endpoints.length>0&&(this.props.store.endpoint_count++,t=this.props.store.endpoint_count%this.props.store.api_endpoints.length,a="https://"+(a=this.props.store.api_endpoints[t]),console.log("next_endpoint",a),this.props.store._chat_api_url=a);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var t,a,r,n,s,o=this,i=T.a.createElement("div",{className:"right-box"},T.a.createElement("div",{className:"row flex md:flex-row flex-col"},T.a.createElement("div",{className:"left flex-1"}),T.a.createElement("div",{className:"right"},T.a.createElement(m.e,{vertical:window.innerWidth<600},window.innerWidth>=600&&window.electronAPI&&(null===(t=window.electronAPI)||void 0===t?void 0:t.pinWindow)&&T.a.createElement(m.b,{active:"yes"==this.props.store._chat_pin_window,icon:"pin",onClick:function(){var e;o.props.store._chat_pin_window="yes"==o.props.store._chat_pin_window?"no":"yes";var t="yes"==o.props.store._chat_pin_window;null===(e=window.electronAPI)||void 0===e||e.pinWindow(t),o.props.store.save_vars("_chat_pin_window"),t&&Object(O.b)("\u5df2\u5c06\u7a97\u53e3\u7f6e\u4e8e\u6700\u4e0a\u65b9")},large:!0}),this.props.store._chat_key&&this.props.store._chat_key.startsWith("fk")&&T.a.createElement(m.h,{className:"md:w-40 w-full",large:!0,rightElement:T.a.createElement(m.b,{icon:"refresh",minimal:!0,onClick:function(){return o.refresh_point()},large:!0}),value:this.state.point+(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_POINT_NAME||"P"),title:"\u4f59\u989d",readOnly:!0}),T.a.createElement(m.b,{icon:"key",onClick:function(){return o.setState({settings_open:!0})},large:!0},"Key\u548c\u5176\u4ed6\u8bbe\u7f6e"),window.innerWidth>=600&&(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_DATA_BUTTON&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_DATA_BUTTON?null:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528".startsWith("http")?T.a.createElement(m.a,{href:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528".replaceAll("{{key}}",encodeURIComponent(e.from(this.props.store._chat_key).toString("base64"))),icon:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_DATA_BTN_ICON||"info-sign",target:"_blank"},Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_DATA_BTN_TEXT||"\u6570\u636e\u5b89\u5168"):T.a.createElement(m.b,{className:"hidden",icon:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_DATA_BTN_ICON||"info-sign",onClick:function(){return Object(O.b)("\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528")},large:!0},Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_DATA_BTN_TEXT||"\u6570\u636e\u5b89\u5168"))))),T.a.createElement("div",{className:"chat-list"},this.state.show_undo?T.a.createElement("div",{className:"text-center gray-btn gray-text"},T.a.createElement(m.c,null,T.a.createElement(m.b,{icon:"undo",minimal:!0,onClick:function(){return o.undo_conversation()}},"\u64a4\u9500"))):null,this.state.list&&this.state.list.map((function(e,t){var a,r;return T.a.createElement("div",{className:"chat-item ".concat(e.role),key:t},T.a.createElement("div",{className:"chat-text content"},T.a.createElement(y.a,{markdown:null===(a=e.text)||void 0===a?void 0:a.trim()}),T.a.createElement("div",{className:"flex flex-row float-icons"},T.a.createElement("span",{className:"remove"},T.a.createElement(m.b,{icon:"trash",small:!0,minimal:!0,title:"\u5220\u9664",onClick:function(){return o.remove_chat_line(t)}})),T.a.createElement("span",{className:"copy"},T.a.createElement(I.CopyToClipboard,{text:null===(r=e.text)||void 0===r?void 0:r.trim(),onCopy:function(){return Object(O.b)("Markdown\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f")}},T.a.createElement(m.b,{icon:"duplicate",small:!0,minimal:!0,title:"\u590d\u5236markdown"}))),Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_TTS&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_TTS?null:T.a.createElement("span",{className:"audio"},T.a.createElement(m.b,{icon:"volume-up",onClick:function(){return o.audio(e.text)},small:!0,minimal:!0,title:"\u8bed\u97f3"})))))})),this.state.typing&&T.a.createElement("div",{className:"chat-item robot"},T.a.createElement("div",{className:"chat-text content"},T.a.createElement(m.n,{size:12,className:"mr-2"}),T.a.createElement(y.a,{markdown:null===(a=this.state.typing)||void 0===a?void 0:a.trim()}),T.a.createElement(m.b,{icon:"cross",minimal:!0,onClick:function(){return o.abort()}}))),this.state.list&&this.state.list.length>0&&T.a.createElement("div",{className:"text-center gray-btn xs-btn gray-text"},!this.state.snap||Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_SNAP_WATERMARK&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_SNAP_WATERMARK?T.a.createElement(m.c,null,T.a.createElement(m.b,{icon:"refresh",small:!0,minimal:!0,onClick:function(){return o.regen_conversation()}},"\u91cd\u65b0\u751f\u6210"),T.a.createElement(m.b,{icon:"eraser",small:!0,minimal:!0,onClick:function(){return o.clean_conversation(!1)}},"\u6e05\u7a7a\u8bb0\u5f55"),T.a.createElement(m.b,{icon:"download",small:!0,minimal:!0,onClick:function(){return o.export_conversation()}},"\u5bfc\u51fa\u622a\u56fe")):T.a.createElement("div",{className:"text-center mt-2"},T.a.createElement("span",{className:"text-gray-400 p-2 px-3 "},Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NAME?"- By ".concat(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NAME).concat(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_WEBSITE?" \xb7 "+Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_WEBSITE:""," -"):"- By Chat\u9171 c3.level06.com -")))),T.a.createElement("div",{className:"chat-box"},T.a.createElement("form",{action:"post",id:"chat-form",className:"flex flex-col",onSubmit:function(e){var t;e.preventDefault(),o.send(null===(t=o.state.text)||void 0===t?void 0:t.trim())}},T.a.createElement(m.q,{growVertically:!0,large:!0,rows:4,inputRef:this.inputRef,disabled:this.state.loading,placeholder:"\u8f93\u5165\u4f60\u7684\u95ee\u9898",autoFocus:!0,className:"input-box",onChange:function(e){return o.onChange(e,"text")},value:this.state.text}),T.a.createElement("div",{className:"flex md:flex-row md:justify-between flex-col items-center mb-2"},T.a.createElement("div",{className:"left flex flex-row items-center"},T.a.createElement(b.a,{onUpdate:function(e){return o.warning(e)},className:"mt-2 mb-2 md:mb-0 md:block hidden",field:"_chat_model",options:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_GPT_NAME&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_GPT_NAME?[{label:"3.5",value:"gpt-3.5-turbo"},{label:"3.5-16K",value:"gpt-3.5-turbo-16k"},{label:"4",value:"gpt-4"}]:[{label:"GPT3.5",value:"gpt-3.5-turbo"},{label:"GPT3.5-16K",value:"gpt-3.5-turbo-16k"},{label:"GPT4",value:"gpt-4"}]}),T.a.createElement("div",{className:"mt-2 md:hidden block mr-1"},T.a.createElement(m.b,{onClick:function(){return o.toggle_version()},large:!0},"gpt-4"==this.props.store._chat_model?"4":"gpt-3.5-turbo-16k"==this.props.store._chat_model?"3.5+":"3.5")),T.a.createElement(m.c,{className:"mt-2 md:mt-0"},T.a.createElement(m.b,{large:!0,className:"md:mt-2 md:ml-1",icon:this.state.loading?T.a.createElement(m.n,{size:12}):"send-message",type:"submit",disabled:this.state.loading},this.state.loading?"\u8bf7\u7a0d\u5019":"\u53d1\u9001(cmd/ctrl+enter)"),T.a.createElement(m.b,{large:!0,className:"md:mt-2 ",icon:"clean",onClick:function(){return o.clean_conversation()}},"\u65b0\u5bf9\u8bdd"))),T.a.createElement("div",{className:"right hidden md:block flex flex-row items-center justify-center"},"yes"!=this.props.store._chat_auto_save?T.a.createElement(m.b,{large:!0,className:"mt-2 ml-2",icon:"floppy-disk",onClick:function(){return o.save_conversation()}},"\u4fdd\u5b58\u5bf9\u8bdd"):T.a.createElement(v.a,{onUpdate:function(){return o.props.store.save_vars()},field:"_chat_auto_save",label:"\u81ea\u52a8\u4fdd\u5b58\u4f1a\u8bdd",className:"no-margin",options:[{label:"\u662f",value:"yes"},{label:"\u5426",value:"no"}]}))))));(this.state.actions?Object.keys(this.state.actions).map((function(e){if(e.trim().length>0)return{label:e,value:e}})):[]).unshift({label:"\u8bf7\u9009\u62e9",value:""});var c=T.a.createElement("div",{className:"prompt-tab"},T.a.createElement("div",{className:"prompt-list"},this.props.store._preset_saved_list&&(null===(r=this.props.store._preset_saved_list)||void 0===r?void 0:r.slice().reverse().map((function(e,t){return T.a.createElement("div",{key:t,className:"prompt-item mb-2 border rounded mb-2 p-2 text-sm text-gray-400 hover:text-blue-400 flex flex-row justify-between  cursor-pointer",onClick:function(){return o.load_prompt(e.id)}},T.a.createElement("div",{className:"left flex flex-row items-center"},e.title.substring(0,30)),T.a.createElement("div",{className:"right action-icon ml-2 gray-btn"},T.a.createElement(m.b,{small:!0,minimal:!0,icon:"edit",title:"\u7f16\u8f91",onClick:function(t){o.edit_prompt(e.id),t.preventDefault(),t.stopPropagation()}}),T.a.createElement(m.b,{small:!0,minimal:!0,icon:"cross",title:"\u5220\u9664",onClick:function(t){o.remove_prompt(e.id),t.preventDefault(),t.stopPropagation()}})))}))),T.a.createElement("div",{className:"bottom-effect"}))),_=T.a.createElement("div",{className:"history-tab"},T.a.createElement("div",{className:"history-list"},this.props.store._chat_saved_list&&(null===(n=this.props.store._chat_saved_list)||void 0===n?void 0:n.slice().reverse().map((function(e,t){return T.a.createElement("div",{key:t,className:"history-item mb-2 border rounded mb-2 p-2 text-sm text-gray-400 hover:text-blue-400 flex flex-row justify-between"},T.a.createElement("div",{className:"left flex flex-row items-center"},e.name.substring(0,30)),T.a.createElement("div",{className:"right action-icon ml-2 gray-btn"},T.a.createElement(m.b,{small:!0,minimal:!0,icon:"history",title:"\u8f7d\u5165",onClick:function(){return o.load_list(JSON.stringify(e.list))}}),T.a.createElement(m.b,{small:!0,minimal:!0,icon:"cross",title:"\u5220\u9664",onClick:function(){return o.remove_list(e.id)}})))}))),T.a.createElement("div",{className:"bottom-effect"}))),p=T.a.createElement("div",{className:"left-box flex-1"},T.a.createElement("div",null,T.a.createElement("div",{className:"text-lg mb-2 text-gray-300 mt-6 mr-2 flex flex-row w-48"},T.a.createElement(m.p,{id:"left-tab",onChange:function(e){o.setState({tab_selected:e})},selectedTabId:this.state.tab_selected,className:"w-full"},T.a.createElement(m.o,{id:"prompt",title:"\u63d0\u793a\u8bcd",panel:c}),T.a.createElement(m.o,{id:"history",title:"\u5bf9\u8bdd\u8bb0\u5f55",panel:_}),T.a.createElement(m.p.Expander,null),T.a.createElement(m.c,null,"prompt"==this.state.tab_selected&&T.a.createElement(m.b,{onClick:function(){return o.prompt_add()},icon:"plus",className:"gray-btn",minimal:!0,title:"\u6dfb\u52a0\u9884\u7f6e\u63d0\u793a\u8bcd"}),T.a.createElement(m.b,{onClick:function(){return o.fileInput.click()},icon:"circle-arrow-up",className:"gray-btn",minimal:!0,title:"\u5bfc\u5165"}),T.a.createElement("input",{type:"file",accept:".json",ref:function(e){o.fileInput=e},style:{display:"none"},onChange:this.handleFile}),T.a.createElement(m.b,{icon:"circle-arrow-down",className:"gray-btn",minimal:!0,onClick:function(){return o.export(o.state.tab_selected)},title:"\u5bfc\u51fa"}))))),Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_LOGO&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_LOGO?null:T.a.createElement("div",{className:null!==(s="char-box opacity-"+this.props.store._chat_char_opacity)&&void 0!==s?s:80},T.a.createElement("img",{src:this.props.store._chat_avatar_url||Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_LOGO||"char.png",onError:function(){o.props.store._chat_avatar_url&&(o.props.store._chat_avatar_url=null)},className:"char",onClick:function(){return o.setState({avatar_open:!0})},style:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_LOGO_STYLE?Object(j.a)(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_LOGO_STYLE):null}),T.a.createElement(N.a,{className:"slider",field:"_chat_char_opacity",min:10,stepSize:10,labelStepSize:10,onUpdate:function(){return o.props.store.save_vars()}}))),l=window.origin+"/#share/"+encodeURIComponent(e.from(JSON.stringify({_chat_key:this.props.store._chat_key,_chat_api_url:this.props.store._chat_api_url})).toString("base64")),u=Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_KEY_BUTTON&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_KEY_BUTTON?null:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_LINK?T.a.createElement(m.a,{large:!0,icon:"key",href:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_LINK.replaceAll("{{key}}",encodeURIComponent(e.from(this.props.store._chat_key).toString("base64"))),target:"_blank"},Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_TEXT||"\u70b9\u6b64\u7533\u8bf7Key"):T.a.createElement(m.a,{large:!0,icon:"key",href:"https://api2d.com/r/186008",target:"_blank"},"\u7533\u8bf7Forward Key \xb7 \u53ef\u5fae\u4fe1\u5145\u503c"),A="c.level06.com"==window.location.hostname||"dd.ftqq.com"==window.location.hostname?T.a.createElement(m.a,{large:!0,icon:"cog",className:"ml-2",href:"https://a.ftqq.com/2023/04/24/chatyou-custom-platform",target:"_blank"},"\u5b9a\u5236Chat\u9171"):null,h=T.a.createElement("div",{className:"flex flex-row chat-page"},p,i,T.a.createElement(m.f,{isOpen:this.state.settings_open,title:"\u8bbe\u7f6e",icon:"info-sign",onClose:function(){return o.setState({settings_open:!1})}},T.a.createElement("div",{className:"p-5 mt-2"},(!Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_KEY||"yes"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_KEY)&&T.a.createElement(T.a.Fragment,null,T.a.createElement(f.a,{field:"_chat_key",label:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_NAME||"KEY",placeholder:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_KEY_PLACEHOLDER||"\u8bf7\u8f93\u5165OpenAI/Forward KEY: sk-xxx/fkxxx"})),Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_API_URL&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_API_URL?null:T.a.createElement(f.a,{field:"_chat_api_url",label:"API\u5730\u5740",placeholder:"\u8bf7\u8f93\u5165API\u5730\u5740\uff0c\u7559\u7a7a\u8bbf\u95eeOpenAI\u5b98\u65b9",disabled:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_MODIFY_API_URL&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_MODIFY_API_URL,rightElement:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_API2D_ENDPOINT_BTN&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_API2D_ENDPOINT_BTN?null:T.a.createElement(m.b,{icon:"random",onClick:function(){return o.changeApiEndpoint()}},"\u5207\u6362api2d\u5730\u5740")}),T.a.createElement("div",{className:"flex flex-row mb-5 items-center"},Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_ADVANCED_SETTINGS_BUTTON&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_ADVANCED_SETTINGS_BUTTON?null:T.a.createElement(m.b,{icon:this.state.show_extend_settings?"chevron-up":"chevron-down",className:"mr-2",large:!0,onClick:function(){return o.setState({show_extend_settings:!o.state.show_extend_settings})}},"\u9ad8\u7ea7\u8bbe\u7f6e"),Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_SHARE_BUTTON&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_SHARE_BUTTON?null:T.a.createElement(T.a.Fragment,null,!window.electronAPI&&T.a.createElement(I.CopyToClipboard,{text:l,onCopy:function(){return Object(O.b)("\u5206\u4eab\u94fe\u63a5\u5df2\u7ecf\u590d\u5236\u5230\u526a\u8d34\u677f\uff0c\u8bf7\u6ce8\u610f\u4fdd\u5bc6\uff0c\u77e5\u9053\u6b64\u94fe\u63a5\u7684\u4eba\u4f1a\u6d88\u8017\u4f60\u7684\u4f59\u989d")}},T.a.createElement(m.b,{icon:"share",large:!0},"\u5206\u4eab\u5e26\u8d26\u53f7\u94fe\u63a5"))),A),this.state.show_extend_settings?T.a.createElement(T.a.Fragment,null,T.a.createElement("div",{className:"flex flex-row"},T.a.createElement(f.a,{field:"_chat_max_tokens",label:"Max Tokens",placeholder:"\u6700\u5927 token \u6570\u91cf\uff0c\u4e00\u822c\u804a\u59291000\u5373\u53ef\uff0c3.5\u6700\u5927\u4e3a4000,4\u4e3a8000\uff0c\u5426\u5219\u5bb9\u6613\u51fa\u9519",className:"mr-2 flex-1"}),T.a.createElement(f.a,{field:"_chat_temperature",label:"\u53d1\u6563\u5ea6",placeholder:"Temperature\uff0c\u53d1\u6563\u7a0b\u5ea6\uff0c0~2\u4e4b\u95f4\uff0c\u8d8a\u5927\u8d8a\u53d1\u6563",className:"flex-1 mr-2"}),T.a.createElement(f.a,{field:"_chat_timeout",label:"\u8d85\u65f6\u65f6\u95f4\xb7\u79d2",placeholder:"\u8d85\u65f6\u4f1a\u81ea\u52a8\u7ec8\u6b62\u8bf7\u6c42",className:"mr-2 flex-1"}),T.a.createElement(f.a,{field:"_chat_history_count",label:"\u5386\u53f2\u4e0a\u4e0b\u6587\u6570\u91cf",placeholder:"\u6bcf\u6b21\u9644\u5e26\u7684\u4e0a\u4e0b\u6587\u6761\u6570\uff0c\u4f1a\u53d7 Max tokens\u9650\u5236",className:"flex-1"})),T.a.createElement("div",{className:"flex flex-row"},T.a.createElement(v.a,{field:"_chat_auto_save",label:"\u81ea\u52a8\u4fdd\u5b58\u4f1a\u8bdd",className:"mr-2",options:[{label:"\u662f",value:"yes"},{label:"\u5426",value:"no"}]}),T.a.createElement(v.a,{field:"_chat_summarize_content",label:"\u4f7f\u7528GPT\u751f\u6210\u4f1a\u8bdd\u6807\u9898"}),this.props.store._chat_key.startsWith("fk")?Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_TTS&&"no"==Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_SHOW_TTS?null:T.a.createElement(v.a,{field:"_chat_auto_audio",label:"\u81ea\u52a8\u6717\u8bfb\u56de\u7b54"}):null),T.a.createElement(f.a,{field:"_chat_system_prompt",label:"\u7cfb\u7edf\u63d0\u793a\u8bcd",placeholder:"system prompt"}),T.a.createElement(f.a,{field:"_chat_user_prompt",label:"\u7528\u6237\u63d0\u793a\u8bcd",placeholder:"user prompt"}),T.a.createElement("div",{className:"flex flex-row"},T.a.createElement(v.a,{field:"_chat_stream",label:"\u6d41\u5f0f\u4f20\u8f93",className:"mr-2",options:[{label:"\u662f",value:"yes"},{label:"\u5426",value:"no"}]}),T.a.createElement(v.a,{field:"_chat_change_model",label:"\u6839\u636e\u957f\u5ea6\u81ea\u52a8\u5207\u63623.5-16K",className:"mr-2",options:[{label:"\u662f",value:"yes"},{label:"\u5426",value:"no"}]}))):null,T.a.createElement(C.a,{onSubmit:function(){return o.save()},cancel:T.a.createElement("div",{className:"flex flex-row"},u)}),T.a.createElement("div",{className:"text-center box-footer text-gray-400"},"- ",(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NAME?Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_API_BASE:"https://openapi.ftqq.com/",REACT_APP_LOCAL_API_BASE:"",REACT_APP_FT_APPID:"26",REACT_APP_DATA_NOTICE:"\u60a8\u7684key\u4fdd\u5b58\u5728\u5ba2\u6237\u7aef\u4e2d\uff0c\u76f4\u63a5\u548cOpenAI/API2d\u901a\u4fe1\uff0cKey\u548c\u6570\u636e\u5747\u4e0d\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u8bf7\u653e\u5fc3\u4f7f\u7528",REACT_APP_SHOW_SETTINGS_BUTTON:"yes",REACT_APP_SETTINGS_BUTTON_TEXT:"Key\u548c\u5176\u4ed6\u8bbe\u7f6e",REACT_APP_SETTINGS_BUTTON_ICON:"key"}).REACT_APP_NAME+" ":"\u65b9\u7cd6\u6c14\u7403 \ud83c\udf88 \u8363\u8a89\u51fa\u54c1 \xb7 Chat\u9171 v")+"".concat(this.props.store.version),"  -"))),T.a.createElement(m.f,{isOpen:this.state.avatar_open,title:"\u8bbe\u7f6e\u804a\u5929\u52a9\u7406\u548c\u80cc\u666f",icon:"info-sign",onClose:function(){return o.setState({avatar_open:!1})}},T.a.createElement("div",{className:"p-5 mt-2"},T.a.createElement(f.a,{field:"_chat_avatar_url",placeholder:"\u8bf7\u7c98\u8d34\u4e00\u4e2a\u53ef\u4ee5\u8bbf\u95ee\u7684\u56fe\u7247URL\uff0c\u6700\u597d\u80cc\u666f\u900f\u660e\uff0c\u5982https://..."}),T.a.createElement(f.a,{field:"_chat_bg_url",placeholder:"\u80cc\u666f\u56fe\u7247URL\uff0c\u5982https://..."}),T.a.createElement(C.a,{onSubmit:function(){return o.avatar_save()},cancel:T.a.createElement(m.b,{onClick:function(){return o.setState({avatar_open:!1})},large:!0},"\u5173\u95ed")}))),T.a.createElement(m.f,{isOpen:this.state.prompt_box,title:"\u5e38\u7528\u63d0\u793a\u8bcd",icon:"info-sign",onClose:function(){return o.prompt_box_clean(!0)}},T.a.createElement("div",{className:"p-5 mt-2"},T.a.createElement(f.a,{field:"_preset_prompt_title",placeholder:"\u63d0\u793a\u8bcd\u6807\u9898"}),T.a.createElement(f.a,{type:"textarea",field:"_preset_user_prompt",placeholder:"user prompt",fill:!0}),T.a.createElement(C.a,{onSubmit:function(){return o.prompt_save()},cancel:T.a.createElement(m.b,{onClick:function(){return o.prompt_box_clean(!0)},large:!0},"\u5173\u95ed")}))));return T.a.createElement(P.a,{title:this.props.store.appname,main:h})}}]),n}(A.Component))||n)||n)||n)}).call(this,a(57).Buffer)},305:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var r,n,s=a(53),o=a(11),i=a(12),c=a(15),_=a(16),p=a(0),l=a.n(p),u=a(8),A=a(41),T=a(1464),h=a(487),E=a(1465),P=a(1463),m=a(486),O=a(174),d=a(17),b=a(23),f=(r=Object(u.b)("store"),Object(A.f)(n=r(n=Object(u.c)(n=function(e){Object(c.a)(a,e);var t=Object(_.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement(T.a,{remarkPlugins:[m.a],className:"markdown-text toastui-editor-contents",children:this.props.markdown,linkTarget:"_blank",components:{code:function(e){e.node;var t=e.inline,a=e.className,r=e.children,n=Object(s.a)(e,["node","inline","className","children"]);if(a&&a.indexOf("hljs")>-1)return l.a.createElement("code",Object.assign({},n,{className:a}),r);var o=/language-(\w+)/.exec(a||"");return t?l.a.createElement("code",Object.assign({className:a},n),r):l.a.createElement("div",{className:"code-box my-2"},l.a.createElement(E.a,Object.assign({children:String(r).replace(/\n$/,""),style:P.a,language:o&&o[1]?o[1]:"bash",PreTag:"div"},n)),l.a.createElement(O.CopyToClipboard,{className:"code-copy",text:String(r),onCopy:function(){return Object(b.b)("\u4ee3\u7801\u5df2\u590d\u5236")}},l.a.createElement(d.b,{icon:"code"},"\u590d\u5236\u4ee3\u7801")))},img:function(e){var t=e.src,a=e.alt;return l.a.createElement(h.a,{showDownload:!0,showRotation:!0,showZoom:!0,small:t,large:t,alt:a})}}})}}]),a}(p.Component))||n)||n)||n)},471:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var r,n,s=a(11),o=a(12),i=a(15),c=a(16),_=a(0),p=a.n(_),l=a(8),u=a(41),A=a(484),T=(r=Object(l.b)("store"),Object(u.f)(n=r(n=Object(l.c)(n=function(e){Object(i.a)(a,e);var t=Object(c.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.props.store[this.props.field]||"",a=this.props.options.filter((function(e){return t==e.value}));Date.now();return p.a.createElement("div",{className:"lossline "+this.props.className||!1},p.a.createElement("div",{className:"lossline"},this.props.label),p.a.createElement(A.a,{menuPlacement:this.props.menuPosition||"auto",placeholder:this.props.placeholder||"\u8bf7\u9009\u62e9",value:a,isMulti:!1,onChange:function(t){e.props.store[e.props.field]=t?t.value:"",e.props.onUpdate&&e.props.onUpdate(t.value)},options:this.props.options||[]}))}}]),a}(_.Component))||n)||n)||n)},480:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var r,n,s=a(11),o=a(12),i=a(15),c=a(16),_=a(0),p=a.n(_),l=a(8),u=a(41),A=a(17),T=(r=Object(l.b)("store"),Object(u.f)(n=r(n=Object(l.c)(n=function(e){Object(i.a)(a,e);var t=Object(c.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e,t,a,r,n,s=this,o=null!==(e=this.props.store[this.props.field])&&void 0!==e?e:0;return p.a.createElement(A.m,{className:this.props.className||"",stepSize:null!==(t=this.props.stepSize)&&void 0!==t?t:10,labelStepSize:null!==(a=this.props.labelStepSize)&&void 0!==a?a:10,min:null!==(r=this.props.min)&&void 0!==r?r:0,max:null!==(n=this.props.max)&&void 0!==n?n:100,value:o,onChange:function(e){s.props.store[s.props.field]=e,s.props.onUpdate&&s.props.onUpdate(e)}})}}]),a}(_.Component))||n)||n)||n)},483:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return h}));var r,n,s=a(11),o=a(12),i=a(15),c=a(16),_=a(0),p=a.n(_),l=a(8),u=a(41),A=a(52),T=a(17),h=(r=Object(l.b)("store"),Object(u.f)(n=r(n=Object(l.c)(n=function(t){Object(i.a)(r,t);var a=Object(c.a)(r);function r(){return Object(s.a)(this,r),a.apply(this,arguments)}return Object(o.a)(r,[{key:"componentDidMount",value:function(){var t=decodeURIComponent(this.props.match.params.info),a=e.from(t,"base64").toString();this.props.store.share_info=a;var r=JSON.parse(a);for(var n in r)this.props.store.hasOwnProperty(n)&&(this.props.store[n]=r[n]);this.props.store.save_vars(),this.props.history.push("/")}},{key:"render",value:function(){var e=p.a.createElement("div",{className:"flex justify-center items-center h-screen"},p.a.createElement("div",{className:"text-center"},p.a.createElement(T.n,null)));return p.a.createElement(A.a,{title:this.props.store.appname,main:e})}}]),r}(_.Component))||n)||n)||n)}).call(this,a(57).Buffer)},52:function(e,t,a){"use strict";var r,n,s,o,i,c,_,p,l,u,A,T,h=a(11),E=a(12),P=a(15),m=a(16),O=a(0),d=a.n(O),b=a(8),f=a(41),C=a(466),y=a.n(C),N=a(29),v=(r=Object(b.b)("store"),Object(f.f)(n=r(n=Object(b.c)(n=function(e){Object(P.a)(a,e);var t=Object(m.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(E.a)(a,[{key:"render",value:function(){var e=this.props.data;return e?d.a.createElement("div",{className:"user-span"},d.a.createElement("img",{src:e.avatar_url,className:"avatar"}),e.name,e.coin>=0&&d.a.createElement("span",{className:"coin bg-blue-500 text-white font-mono text-xs"},e.coin)):null}}]),a}(O.Component))||n)||n),a(53)),I=a(17),S=a(54),R=a(1504),k=a(170),g=(s=Object(b.b)("store"),Object(f.f)(o=s(o=Object(b.c)(o=function(e){Object(P.a)(a,e);var t=Object(m.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(E.a)(a,[{key:"render",value:function(){var e=this,t=d.a.createElement(I.i,{className:"border"},d.a.createElement(I.k,{icon:"person",text:"\u6211\u7684",onClick:function(){return e.props.history.push("/profile")}}),d.a.createElement(I.k,{icon:"dollar",text:"\u5145\u503c",onClick:function(){return e.props.history.push("/recharge")}}),d.a.createElement(I.j,null),d.a.createElement(I.k,{icon:"log-out",text:"\u9000\u51fa",onClick:function(){return e.props.history.push("/logout")}})),a=this.props,r=(a.staticContext,Object(v.a)(a,["staticContext"]));return d.a.createElement("div",r,this.props.store.user?d.a.createElement(R.a,{autoFocus:!1,content:t,position:S.a.BOTTOM_RIGHT},d.a.createElement(I.b,{rightIcon:"caret-down",minimal:!0})):d.a.createElement(k.a,{minimal:!0}))}}]),a}(O.Component))||o)||o),i=Object(b.b)("store"),Object(f.f)(c=i(c=Object(b.c)(c=function(e){Object(P.a)(a,e);var t=Object(m.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(E.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=(t.staticContext,Object(v.a)(t,["staticContext"]));return d.a.createElement("div",a,d.a.createElement("div",{className:"flex flex-row items-center"},this.props.store.menu&&d.a.createElement(d.a.Fragment,null," ",d.a.createElement("svg",{className:"w-3 h-3 mr-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},d.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"}))," "),this.props.store.menu&&this.props.store.menu.map((function(t){var a,r=!0;(t.member_only&&(e.props.store.token||(r=!1)),t.admin_only)&&((null===(a=e.props.store.user)||void 0===a?void 0:a.level)<9&&(r=!1));return r?d.a.createElement(N.c,{className:"nav-menu text-black text-lg hover:text-gray-500 hover:no-underline ",key:t.id,to:t.link},t.text):null}))))}}]),a}(O.Component))||c)||c)||c);_=Object(b.b)("store"),Object(f.f)(p=_(p=Object(b.c)(p=function(e){Object(P.a)(a,e);var t=Object(m.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(E.a)(a,[{key:"render",value:function(){this.props.store.user;return d.a.createElement("div",{className:(this.props.className||"")+" header"},d.a.createElement("div",{className:"container mx-auto"},d.a.createElement("div",{className:"left flex flex-row items-center"},d.a.createElement(N.b,{to:"/"},this.props.store.appname),d.a.createElement(g,{className:"ml-5 hidden md:block"})),d.a.createElement("div",{className:"right"})))}}]),a}(O.Component))||p)||p),l=Object(b.b)("store"),Object(f.f)(u=l(u=Object(b.c)(u=function(e){Object(P.a)(a,e);var t=Object(m.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(E.a)(a,[{key:"render",value:function(){return d.a.createElement("div",{className:(this.props.className||"")+" footer"},"\u65b9\u7cd6\u6c14\u7403 \ud83c\udf88 ftqq.com")}}]),a}(O.Component))||u)||u);a.d(t,"a",(function(){return j}));var j=(A=Object(b.b)("store"),Object(f.f)(T=A(T=Object(b.c)(T=function(e){Object(P.a)(a,e);var t=Object(m.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(E.a)(a,[{key:"render",value:function(){return d.a.createElement(y.a,{title:this.props.title||this.props.store.appname},d.a.createElement(d.a.Fragment,null,this.props.store._chat_bg_url?d.a.createElement("div",{className:"chat-bg"}," ",d.a.createElement("img",{src:this.props.store._chat_bg_url,onError:function(e){return e.target.style.display="none"},referrerPolicy:"no-referrer"})):null,d.a.createElement("div",{className:""},d.a.createElement("div",{className:"body container mx-auto"},this.props.main)),d.a.createElement("div",{className:"drag-handle w-full h-5 fixed top-0 "})))}}]),a}(O.Component))||T)||T)||T)},60:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var r,n,s=a(11),o=a(12),i=a(15),c=a(16),_=a(0),p=a.n(_),l=a(8),u=a(41),A=a(17),T=(r=Object(l.b)("store"),Object(u.f)(n=r(n=Object(l.c)(n=function(e){Object(i.a)(a,e);var t=Object(c.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.props.store[this.props.field]||"";return p.a.createElement(A.g,{label:this.props.label,className:this.props.lineClass||""},"textarea"==this.props.type?p.a.createElement(A.q,{fill:this.props.fill||!1,growVertically:!0,large:!0,placeholder:this.props.placeholder,onChange:function(t){return e.props.store[e.props.field]=t.target.value},value:t,className:this.props.className||""}):p.a.createElement(A.h,{type:this.props.type,large:"true",placeholder:this.props.placeholder,onChange:function(t){return e.props.store[e.props.field]=t.target.value},rightElement:this.props.rightElement||null,value:t,className:this.props.className||"",disabled:this.props.disabled||null}),parseInt(this.props.max_count)>0&&p.a.createElement("div",{className:"text-count"},t.length,"/",this.props.max_count))}}]),a}(_.Component))||n)||n)||n)},600:function(e,t,a){e.exports=a(1462)},605:function(e,t,a){}},[[600,1,2]]]);